{% extends "scout_clients/base.html" %}

{% load static %}
{% load render_bundle from webpack_loader %}

{% block title %}Demo: Vue Django{% endblock %}

{% block content %}

<div class="jumbotron">
  <h1>{{hello}}</h1>
  <p class="lead">Let's experiment with exposing data through 2 popular API server architectures. Then we'll consume the data using client apps built with various techniques.</p>
</div>

<p>The following container will render a vue component with data recieved via an axios request.</p>

<div class="row marketing" style="border:solid 1px red;">

    <h2 class="classic-header">Vue.js</h2>

    <div id="app" class="col-lg-12">

        <button-counter-literal></button-counter-literal>

        <button-counter-inline inline-template>
          <div style="margin-bottom:25px;">
              <button v-on:click="count++">You clicked me [[ count ]] times [[ blah ]]. (inline component)</button>
          </div>
        </button-counter-inline>

        <h2>[[ title ]]</h2>
        <div v-if="loading">
          Loading.....
        </div>
        <ul class="media-list classic-list">
            <li v-for="space in spaces" class="media">
               <div class="media-left">
                  <a href="#"><img className="media-object" src="http://via.placeholder.com/60x60" alt="..." /></a>
              </div>
              <div class="media-body">
                <h4 class="media-heading">[[ space.name ]]</h4>
                <p>[[ space.building_name ]]<br/>
                [[ space.latitude ]], [[ space.longitude ]]</p>
              </div>
           </li>
        </ul>
    </div>

</div>

<!--
<script type="text/javascript" src="{% static "scout_clients/vuejs/button-counter-literal.js" %}"></script>
<script type="text/javascript" src="{% static "scout_clients/vuejs/button-counter-inline.js" %}"></script>
-->

<script>

Vue.component('button-counter-literal', {
  template: `
      <div style="margin-bottom:25px;">
          <button v-on:click="count++">You clicked me {% verbatim %}{{ count }} {{ blah }}{% endverbatim %} times. (string literal component)</button>
      </div>
  `,
  data: function () {
    return {
      count: 0,
      blah: 'balskdfjalkjsda'
    }
  }
})

Vue.component('button-counter-inline', {
  data: function () {
    return {
      count: 0,
      blah: 'balskdfjalkjsda'
    }
  }
})

new Vue({
  delimiters: ['[[', ']]'],
  el: '#app',
  //components: {
  //  'button-counter-literal': ButtonCounterLiteral,
  //  'button-counter-inline': ButtonCounterInline,
  //},
  data: {
    title: 'All Spots',
    loading: true,
    spaces: null
  },
  mounted () {
    this.loading = true;
    axios
      .get('/api/v1/spots/?format=json')
      .then(response => {
          this.spaces = response.data
      })
      .catch(error => {
        console.log(error)
        this.errored = true
      })
      .finally(() => this.loading = false)
  }
})
</script>

{% endblock %}
